language: rust
rust:
  - nightly
  - stable
cache: cargo
addons:
  apt:
    packages:
    - libegl1-mesa-dev
    - libgtk-3-dev
    - libsdl2-dev
    - libglfw3-dev
    - cmake
script:
  - cargo install sccache
  - export RUSTC_WRAPPER=sccache
  - rustup target add aarch64-unknown-linux-gnu
  - cd simd
  - cargo build --target aarch64-unknown-linux-gnu
  - cd ../geometry
  - cargo build --target  aarch64-unknown-linux-gnu
  - cd ..
  - cargo build
  - cargo test
  - cd c
  - cargo cinstall --prefix=$TRAVIS_HOME/.fake-install
  - cd ../examples/c_canvas_glfw_minimal
  - PKG_CONFIG_PATH=$TRAVIS_HOME/.fake-install/lib/pkgconfig make
env:
  global:
    - HARFBUZZ_SYS_NO_PKG_CONFIG=true
notifications:
  webhooks: http://build.servo.org:54856/travis
